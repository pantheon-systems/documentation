---
contenttype: [partial]
categories: [dependencies]
cms: [--]
product: [integrated-composer]
integration: [--]
tags: [--]
reviewed: ""
---

The upstream has the following directory structure:

```none:title=code/
code/
├─ .gitignore
├─ composer.json
└─ pantheon.upstream.yml
├─ README.md
└─ upstream-configuration/ or upstream-config/ for WordPress
   └─ composer.json
└─ web/
   └─ sites/ for Drupal
   └─ wp-content/ for WordPress
```

- `.gitignore`: Prevents [build artifacts](/guides/integrated-composer#build-and-deploy-terminology) generated by Composer from being committed to the upstream or site code repositories. Note that changing the tracking status of Composer-managed files and directories can result in build failures or lead to unexpected errors.
- `composer.json`: The two different `composer.json` files allows you to customize individual sites without inherent merge conflicts and enables one-click updates.
  - Root-level: Site-level customizations.
  - Drupal: `upstream-configuration/` or WordPress: `upstream-config/`:
    - `composer.json`: Composer automatically updates `composer.json` with customizations for the upstream. Avoid manually modifying this file.
- `pantheon.upstream.yml`: The `build_step: true` directive in `pantheon.upstream.yml` enables the build step.

When a site is created, Pantheon runs `composer install`, generates a `composer.lock` file, and commits it back to the site’s code repository. To avoid potential merge conflicts after applying an upstream update, do not commit the `composer.lock` file from your upstream root to the upstream repository.

Since the `composer.lock` file should be committed for individual sites created from your custom upstream, it should not be listed in your .gitignore file. To make it easier to avoid accidentally commit a `composer.lock` file when working directly with your custom upstream, run the following command:

       echo /composer.lock >> .git/info/exclude

This will have the same effect as ignoring the file in the top-level .gitignore file, except that the `exclude` file is not saved in the repository when you push changes back to the remote origin. You therefore must re-run this command every time you make a new local clone of your upstream if you would like to protect against inadvertently committing a composer.lock file.

Build artifacts are stored in a Git tag like `pantheon_build_artifacts_$BRANCHNAME`, where `$BRANCHNAME` is the name of the environment or Multidev feature branch.

It is a requirement that all build artifacts should be ignored in the `.gitignore` file. Ensure you add entries to the `.gitignore` any time you modify the build to move installation files to a new locations.
